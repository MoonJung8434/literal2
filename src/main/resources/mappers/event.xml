<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- event.xml -->

<mapper namespace="event">

	<!-- 이벤트 등록 -->
    <insert id="insert" parameterType="java.util.Map">
        INSERT INTO event (event_code, event_title, event_content, start_date, end_date, event_discount, book_number, book_code)
        VALUES (#{event_code}, #{event_title}, #{event_content}, #{start_date}, #{end_date}, #{event_discount}, #{book_number}, #{book_code})
    </insert>

	<!-- 이벤트 전체 리스트 -->
 	<select id="list" resultType="java.util.Map">
		SELECT event_code, event_title, event_content, start_date, end_date, event_date
        FROM event
        ORDER BY event_date DESC
	</select>

    <!-- 새로운 event 코드 생성 -->
    <select id="get_eventcode" resultType="int">
        SELECT COALESCE(MAX(CAST(SUBSTRING_INDEX(event_code, '-', -1) AS UNSIGNED)), 0) + 1
        FROM event
    </select>
    
    
    
</mapper>
